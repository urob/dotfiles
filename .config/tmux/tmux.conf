# Set the prefix from `C-b` to `C-a`
set-option -g prefix C-a
unbind C-b              # free the original 'Ctrl-b' to Oher apps
bind C-a send-prefix    # ensure that we can send 'Ctrl-a' to other apps

# Use Ctrl-a Ctrl-a/a to switch to last window
bind C-a last-window
bind a last-window
unbind l

# Reload the file with Prefix r.
bind r source-file $XDG_CONFIG_HOME/tmux/tmux.conf \; display "Reloaded tmux conf"

# Create new tmux window and prompt for a name
#bind-key c command-prompt -p "window name:" "new-window; rename-window '%%'"

# Turn on mouse support
setw -g mouse on

# Renumber remaining windows when one is closed
#set-option renumber-windows on

# Use the mouse drag to re-order windows
bind-key -n MouseDrag1Status swap-window -t=

# Scroll History
set-option -g history-limit 30000

# Fix delay after sending esc
set-option -sg escape-time 10

# Use h and v to split windows, swapped to be consist w/ how vim defines splits
unbind x
bind x split-window -v -c "#{pane_current_path}"
bind v split-window -h -c "#{pane_current_path}"
unbind '"'
unbind %

# Rebind k to kill pane
bind k confirm-before -p "kill-pane #P? (y/n)" kill-pane

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind -n M-n if-shell "$is_vim" "send-keys M-n" "select-pane -L"
bind -n M-e if-shell "$is_vim" "send-keys M-e" "select-pane -D"
bind -n M-u if-shell "$is_vim" "send-keys M-u" "select-pane -U"
bind -n M-i if-shell "$is_vim" "send-keys M-i" "select-pane -R"
bind -n M-o if-shell "$is_vim" "send-keys M-o" "select-pane -l"
bind -n M-j resize-pane -Z  # Alt-J
bind -n C-j resize-pane -Z  # Ctrl-Enter

# bindings for when in copy mode
#bind-key -T copy-mode-vi 'M-n' select-pane -L
#bind-key -T copy-mode-vi 'M-e' select-pane -D
#bind-key -T copy-mode-vi 'M-u' select-pane -U
#bind-key -T copy-mode-vi 'M-i' select-pane -R
#bind-key -T copy-mode-vi 'M-o' select-pane -l

# <prefix> + b toggles status bar
bind b set-option -g status

# make sure we have full color support
set-option -g default-terminal "tmux-256color"
set-option -ag terminal-overrides ',xterm-256color:Tc'
set-option -g focus-events on

# set terminal titles
set-option -g set-titles on
set-option -g set-titles-string "Tmux / #S"

# +-----------+
# | STATUSBAR |
# +-----------+

# color definitions, hidden attribute requires Tmux v3.2 or later
%hidden cs_fg=colour240       # foreground color
%hidden cs_bg=default         # background color
%hidden hl_bg=#323836         # highlight background
#%hidden hl_bg=brightblue      # highlight background
#%hidden hl_bg=#504945         # highlight background

# status bar globals
setw -g status-style fg=$cs_fg,bg=$cs_bg,none
set-option -g status-interval 2                        # update status every 2 seconds
set-option -g status-justify left                      # juft justify the window list

# hide left status bar (default: session number)
set-option -g status-left ''

# change background for current window
setw -g window-status-current-style fg=$cs_fg,bg=$hl_bg,none

# use multicolor status prompts for all windows
setw -g window-status-current-format ' #[fg=brightred]#I#[fg=colour240]:#W#[fg=brightblue]#F '
setw -g window-status-format ' #[fg=brightred]#I#[fg=colour240]:#W#[fg=brightblue]#F '

# status bar right (time / date)
#set-option -g status-right '%-m/%-d · %I:%M %p'    # %-m/%-d/%Y
set-option -g status-right '#{?client_prefix,#[bg=brightred] - PREFIX - ,%-m/%-d · %I:%M %p}'
set-option -g status-right-length 20

# +--------------+
# | OTHER COLORS |
# +--------------+

# messages
setw -g message-style fg=$cs_fg,bg=brightred
setw -g message-command-style fg=brightwhite,bg=brightred  # vi command mode

setw -g window-status-bell-style fg=$cs_fg,bg=$hl_bg

# scroll indicator
setw -g mode-style fg=$cs_fg,bg=$hl_bg

# pane borders
setw -g pane-active-border-style fg=yellow,bg=default
setw -g pane-border-style fg=white,bg=default

